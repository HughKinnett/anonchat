<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="timeline.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline</title>
</head>
<body>
    <div class="profile-banner">
        <img src="profile-pic.jpg" alt="Profile Picture">
        <h1>User Name</h1>
        <p>@username</p>
    </div>
    <form id="post-form">
        <textarea name="post-content" id="post-content" placeholder="What's happening?" required></textarea>
        <button type="submit">Post</button>
    </form>
    <ul class="feed">
        <li class="feed-item">
            <h3>User Name</h3>
            <p>Content...</p>
        </li>
    </ul>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAyIEUtkZMQwjfDum146Hs1ThXpnbXilEk",
            authDomain: "anonchatlogin.firebaseapp.com",
            projectId: "anonchatlogin",
            storageBucket: "anonchatlogin.appspot.com",
            messagingSenderId: "734396560776",
            appId: "1:734396560776:web:7b93978b3ccaa3007ab63d",
            measurementId: "G-WB746MBDXT"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.getElementById('post-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const postContent = document.getElementById('post-content').value;
            try {
                const docRef = await addDoc(collection(db, "posts"), {
                    content: postContent,
                    timestamp: new Date()
                });
                console.log("Document written with ID: ", docRef.id);
                // Update the feed with the new post without reloading the page
                const feed = document.querySelector('.feed');
                const newPost = document.createElement('li');
                newPost.classList.add('feed-item');
                newPost.innerHTML = `<h3>User Name</h3><p>${postContent}</p>`;
                feed.prepend(newPost);
                document.getElementById('post-content').value = ''; // Clear the textarea
            } catch (e) {
                console.error("Error adding document: ", e);
            }
        });
    </script>
</body>
</html>