<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="timeline.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline</title>
</head>
<body>
    <div class="profile-banner">
        <img src="profile-pic.jpg" alt="Profile Picture">
        <h1>User Name</h1>
        <p>@username</p>
    </div>
    <form id="post-form">
        <textarea name="post-content" id="post-content" placeholder="What's happening?" required></textarea>
        <button type="submit">Post</button>
    </form>
    <ul class="feed" id="feed">
        <!-- Existing feed items will be dynamically populated here -->
    </ul>
    <script> // Function to render posts
        function renderPost(doc) {
            const feed = document.getElementById('feed');
            const newPost = document.createElement('li');
            newPost.classList.add('feed-item');
            newPost.innerHTML = `<h3>User Name</h3><p>${doc.data().content}</p>`;
            feed.prepend(newPost);
        }

        // Real-time listener for posts
        const q = query(collection(db, "posts"), orderBy("timestamp", "desc"));
        onSnapshot(q, (snapshot) => {
            const feed = document.getElementById('feed');
            feed.innerHTML = ''; // Clear the feed
            snapshot.forEach((doc) => {
                renderPost(doc);
            });
        });

        document.getElementById('post-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const postContent = document.getElementById('post-content').value;
            try {
                await addDoc(collection(db, "posts"), {
                    content: postContent,
                    timestamp: new Date()
                });
                document.getElementById('post-content').value = ''; // Clear the textarea
            } catch (e) {
                console.error("Error adding document: ", e);
            }
        });
    </script>
</body>
</html>